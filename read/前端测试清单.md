# 前端功能复测清单 - 测试结果

> 测试时间: 2026/01/23 18:25
> 测试环境: Chrome / localhost:5173

## 0. 追踪信息
- 关联任务编号：`C1`、`C2`
- 关联变更编号：`TH-2026-02-005`、`TH-2026-02-006`
- 关联任务文档：`read/功能任务清单.md`
- 关联变更文档：`read/项目变更日志.md`

## 1. 登录与路由
- **页面**: `/login`
- **测试结果**: ✅ **通过**
- **详情**:
  - 输入账号 `1000000` / `admin123` 登录成功。
  - 成功跳转到 `/dashboard`。
  - 仪表盘内容（如“早安，x先生”）加载正常。

## 2. 健康档案
- **页面**: `/health`
- **测试结果**: ✅ **通过**
- **详情**:
  - 填写姓名、性别、年龄、身高、体重、高血压、海鲜过敏等信息。
  - 点击“保存”提示成功。
  - **关键验证**: 刷新页面后，所有填写的数据（包括复选框选项）均自动回填，证明数据持久化成功。

## 3. 健康记录(综合)
- **页面**: `/health` -> “数据记录”
- **测试结果**: ✅ **通过** (作为 Profile 测试的一部分验证)
- **详情**:
  - 在 Profile 流程中填写了身高体重，保存后刷新并未丢失。

## 4. 饮食记录
- **页面**: `/diet`
- **测试结果**: ⚠️ **部分通过**
- **详情**:
  - **功能正常**: 选择食物（米饭）、分量（一拳）并提交，提示“记录成功”。
  - **Dashboard 联动正常**: 仪表盘上的“今日餐次”计数从 3 增加到 4。
  - **UI 缺失**: 页面下方**未显示历史记录列表**，导致用户无法直观看到刚刚添加的记录（只能通过计数间接确认）。这是一个体验问题。

## 5. 食谱中心
- **页面**: `/plan`
- **测试结果**: ⚪ **未完全验证**
- **备注**: 后端测试中已知生成过程较慢，建议手动验证。

## 6. AI 营养师对话
- **页面**: `/chat`
- **测试结果**: ⚪ **未验证** (依赖流式 API)

## 7. 个性化设置
- **页面**: `/settings`
- **测试结果**: ⚪ **未验证**

## 8. 个人中心
- **页面**: `/user/profile`
- **测试结果**: ⚪ **未验证**

## 9. 管理员(仅 ADMIN)
- **页面**: `/admin/users`
- **测试结果**: ⚪ **未验证**

---

## 总结
核心的 **档案保存** 和 **饮食记录提交** 功能（即之前数据库报错的两个点）现在前端均已可用。
**改进建议**: `/diet` 页面急需增加一个“今日记录列表”组件，否则用户会有“我到底记没记上”的疑惑。

## 10. C1/C2 专项回归用例（待执行）
| 编号 | 关联任务 | 用例 | 步骤 | 预期结果 |
| --- | --- | --- | --- | --- |
| FE-C1-001 | C1 | 默认本周筛选 | 进入健康档案历史记录页 | 默认选中“本周”，并以周一为起始日过滤 |
| FE-C1-002 | C1 | 预设时间筛选 | 依次选择 1天/3天/1周/1月/全部 | 列表与统计随筛选条件正确变化 |
| FE-C1-003 | C1 | 自定义时间区间 | 选择起止日期后查询 | 仅展示区间内记录，起止边界包含正确 |
| FE-C2-001 | C2 | 首次弹窗 | 新账号首次进入数据记录页 | 自动弹出长期数据录入弹窗 |
| FE-C2-002 | C2 | 非首次不弹窗 | 首次保存后离开并再次进入 | 不再自动弹窗 |
| FE-C2-003 | C2 | 手动入口可编辑 | 通过入口打开长期数据编辑 | 可修改并保存成功，刷新后仍保留 |

## 11. 仪表盘真实数据回归（待执行）
| 编号 | 关联变更 | 用例 | 步骤 | 预期结果 |
| --- | --- | --- | --- | --- |
| FE-DB-001 | TH-2026-02-019 | BMI/血压卡片取真实数据 | 档案中填写身高体重与血压后刷新仪表盘 | BMI与血压卡片展示真实值与对应状态 |
| FE-DB-002 | TH-2026-02-019 | 今日餐次卡片取真实数据 | 当天新增不同餐次饮食记录 | 餐次卡片计数随真实记录变化 |
| FE-DB-003 | TH-2026-02-019 | 今日健康记录卡片取真实数据 | 当天新增健康记录 | 记录卡片计数与进度同步变化 |
| FE-DB-004 | TH-2026-02-019 | 一周趋势图取真实数据 | 连续录入多天健康记录后查看仪表盘 | 趋势图按7天真实数据绘制，非固定曲线 |
| FE-DB-005 | TH-2026-02-019 | 今日餐次结构图取真实数据 | 新增含热量的饮食记录后查看仪表盘 | 饼图按当日餐次热量分布展示 |
| FE-DB-006 | TH-2026-02-019 | 新用户空数据友好提示 | 使用未录入任何数据的新账号登录 | 显示引导提醒，不报错不白屏 |
| FE-DB-007 | TH-2026-02-023 | 环图点击切换口径 | 在“今日热量结构”点击环图 | 在“按餐次”与“按食物类型”之间切换，标签同步更新 |
| FE-DB-008 | TH-2026-02-023 | 食物类型口径展示 | 记录多种食物后切到“按食物类型” | 环图按碳水/蛋白质/脂肪/蔬果/其他分类展示热量占比 |

## 12. 首页卡片自定义回归（待执行）
| 编号 | 关联变更 | 用例 | 步骤 | 预期结果 |
| --- | --- | --- | --- | --- |
| FE-CARD-001 | TH-2026-02-020 | 设置页可配置卡片 | 进入设置页“显示与偏好”，查看首页卡片展示项 | 可勾选/取消可选卡片，固定图表提示清晰 |
| FE-CARD-002 | TH-2026-02-020 | 关闭卡片后首页生效 | 取消“BMI 指数”并保存，回首页 | BMI 卡片隐藏，其他卡片正常 |
| FE-CARD-003 | TH-2026-02-020 | 开启新增卡片后首页生效 | 勾选“本周平均血糖/待处理控糖任务”并保存 | 首页显示对应卡片且数据真实 |
| FE-CARD-004 | TH-2026-02-020 | 配置持久化 | 保存卡片配置后刷新页面/重新登录 | 首页卡片配置保持一致，不恢复默认 |
| FE-CARD-005 | TH-2026-02-020 | 新用户默认配置 | 新账号首次登录查看首页 | 首页按默认卡片配置展示，可在设置中修改 |
| FE-CARD-006 | TH-2026-02-021 | 卡片无内部滚动条 | 首页展示包含“今日餐次记录”等卡片 | 卡片内容完整展示，不出现内部滚动条 |
| FE-CARD-007 | TH-2026-02-021 | 两行卡片间距稳定 | 首页展示多于4张卡片形成两行 | 两行卡片间距正常，无重叠或遮挡 |
| FE-PLAN-001 | TH-2026-02-024 | 每餐热量显示为计算值 | 生成任意周期食谱并查看表格 | 每餐显示 `xxx kcal` 且非空 |
| FE-PLAN-002 | TH-2026-02-024 | 每餐三大营养素显示 | 生成食谱后查看早餐/午餐/晚餐单元格 | 显示“碳水/蛋白/脂肪”克数 |
| FE-PLAN-003 | TH-2026-02-024 | PDF导出营养信息 | 导出食谱 PDF | 每餐下方包含碳水/蛋白/脂肪数据 |
| FE-PLAN-004 | TH-2026-02-027 | 历史需求展示 | 在食谱中心生成过食谱后返回生成区 | 可看到“历史需求”标签列表 |
| FE-PLAN-005 | TH-2026-02-027 | 历史需求一键复用 | 点击任意历史需求标签 | 需求输入框被填充为该标签文本 |
| FE-PLAN-006 | TH-2026-02-027 | 生成后历史同步 | 输入新需求并生成成功 | 新需求出现在历史需求列表前列 |
| FE-PLAN-007 | TH-2026-02-030 | 生成后自动保存 | 输入需求并成功生成食谱 | 食谱自动进入“已保存食谱”列表，无需点击保存 |
| FE-PLAN-008 | TH-2026-02-030 | 自动保存提示 | 成功生成后查看生成区按钮行 | 显示“已自动保存到食谱中心”提示，不再需要保存按钮 |
| FE-PLAN-009 | TH-2026-02-030 | 列表自动刷新 | 生成成功后不手动刷新列表 | 新食谱记录即时出现在已保存食谱列表 |
| FE-AUTH-001 | TH-2026-02-028 | 业务码500自动退出 | 构造接口返回 `code=500` | 自动清理登录态并跳转登录页 |
| FE-AUTH-002 | TH-2026-02-028 | HTTP 500/502/503/504 自动退出 | 构造网关或后端异常响应 | 自动清理登录态并跳转登录页 |
| FE-AUTH-003 | TH-2026-02-028 | 401/403 统一退出逻辑 | 使用过期 token 访问受限接口 | 自动清理登录态并跳转登录页 |
| FE-AUTH-004 | TH-2026-02-028 | AI流式对话异常自动退出 | 在 `/api/chat/stream` 返回 500/403 | 自动清理登录态并跳转登录页 |
