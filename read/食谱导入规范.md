# 食谱导入格式规范（Excel）

> 说明：Excel（.xlsx）优先。PDF 导入仅支持系统导出的 PDF（结构化表格）。

## 0. 追踪信息
- 关联任务编号：`B3`
- 关联变更编号：`TH-2026-02-004`
- 关联任务文档：`read/功能任务清单.md`
- 关联变更文档：`read/项目变更日志.md`

## 1. 文件要求
- 文件格式：`.xlsx`
- 表头：必须有且仅一行表头
- Sheet：默认读取第一个工作表

## 2. 列字段定义（从左到右）
| 列名 | 必填 | 示例 | 说明 |
| --- | --- | --- | --- |
| 日期 | 是 | 周一 / 2025-01-01 | 一天的标识，可用“周一/周二”或具体日期字符串 |
| 餐次 | 是 | 早餐 / 午餐 / 晚餐 / 加餐 | 只能填写这四种（大小写不敏感） |
| 菜品 | 是 | 鸡胸肉、糙米饭、青菜 | 多个菜品可用 `、` `,` `;` `|` 分隔 |
| 热量 | 否 | 520kcal | 可留空，不会影响导入 |
| 备注 | 否 | 少盐少油 | 仅作为说明，不参与计算 |

## 3. 导入后的行为
- 系统会按“日期”聚合为每日食谱。
- 同一天的不同餐次会合并到同一个日计划。
- 若同一天同一餐次重复，后写入的行覆盖前一行。
- 食谱标题默认使用文件名（不含扩展名），可在导入时手动填写标题覆盖。
- 周期自动识别规则：
  - 仅 1 条记录：识别为“一顿饭”
  - 1 天多条记录：识别为“一天”
  - 3 天记录：识别为“三天”
  - >= 7 天记录：识别为“一周”

## 4. 示例（表格）
| 日期 | 餐次 | 菜品 | 热量 | 备注 |
| --- | --- | --- | --- | --- |
| 周一 | 早餐 | 燕麦粥、鸡蛋 | 350kcal | 低盐 |
| 周一 | 午餐 | 清蒸鱼、糙米饭、青菜 | 600kcal |  |
| 周一 | 晚餐 | 蔬菜汤、全麦面包 | 400kcal |  |
| 周二 | 早餐 | 小米粥、鸡蛋 | 330kcal |  |

## 5. 常见问题
- **菜品为空**：该行会被忽略。
- **餐次写错**：该行会被忽略。
- **日期为空**：会自动按“第N天”生成。

## 6. PDF 导入规则（仅限系统导出 PDF）
- 仅支持系统内“导出食谱 PDF”生成的文件。
- 会尝试识别：标题、建议、每日三餐与采购清单。
- 如果 PDF 内容是扫描图或结构不一致，可能无法识别。
